<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>TITE-CRM and TITE-NBG - Time-to-Event Designs</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">TITE-CRM and TITE-NBG - Time-to-Event
Designs</h1>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<div id="tite-crm" class="section level2">
<h2>TITE-CRM</h2>
<p><span class="citation">Y. K. Cheung and Chappell (2000)</span>
introduced TITE-CRM as a variant of the regular CRM <span class="citation">(O’Quigley, Pepe, and Fisher 1990)</span> that handles
late-onset toxicities. Dose-finding trials tend to use a short toxicity
window after the commencement of therapy, during which each patient is
evaluated for the presence or absence of dose-limiting toxicity (DLT).
This approach works well in treatments like chemotherapy where toxic
reactions are expected to manifest relatively quickly. In contrast, one
of the hallmarks of radiotherapy, for instance, is that related adverse
reactions can manifest many months after the start of treatment. A
similar phenomenon may arise with immunotherapies.</p>
<p>In adaptive dose-finding clinical trials, where doses are selected
mid-trial in response to the outcomes experienced by patients evaluated
hitherto, late-onset toxic events present a distinct methodological
challenge. Naturally, the toxicity window will need to be long enough to
give the trial a good chance of observing events of interest. If,
however, we wait until each patient completes the evaluation window
before using their outcome to forecast the best dose, the trial may take
an infeasibly long time and ignore pertinent interim data.</p>
<p>TITE-CRM presents a solution by introducing the notion of a
<em>partial tolerance</em> event. If a patient is half way through the
evaluation window and has not yet experienced toxicity, we may say that
they have experienced half a tolerance. This simple novelty allows
partial information to be used in dose-recommendation decisions. If the
patient goes on to complete the window with no toxic reaction, they will
be regarded as having completely tolerated treatment, as is normally the
case with CRM and other dose-finding algorithms. This notion of partial
events is only applied to tolerances, however. If a patient experiences
toxicity at any point during the evaluation window, they are immediately
regarded as having experienced 100% of a DLT event.</p>
<p>To illustrate TITE-CRM mathematically, we start with the likelihood
from the plain vanilla CRM. Let <span class="math inline">\(Y_i\)</span>
be a random variable taking values <span class="math inline">\(\{0,
1\}\)</span> reflecting the absence and presence of DLT respectively in
patient <span class="math inline">\(i\)</span>. A patient administered
dose <span class="math inline">\(x_i\)</span> has estimated probability
of toxicity <span class="math inline">\(F(x_i, \theta)\)</span>, where
<span class="math inline">\(\theta\)</span> represents the set of model
parameters. The likelihood component arising from patient <span class="math inline">\(i\)</span> is</p>
<p><span class="math display">\[ F(x_i, \theta)^{Y_i} (1 - F(x_i,
\theta))^{1-Y_i} \]</span></p>
<p>and the aggregate likelihood after the evaluation of <span class="math inline">\(J\)</span> patients is</p>
<p><span class="math display">\[ L_J(\theta) = \prod_{i=1}^J \left\{
F(x_i, \theta) \right\}^{Y_i} \left\{ 1 - F(x_i, \theta)
\right\}^{1-Y_i} \]</span></p>
<p><span class="citation">Y. K. Cheung and Chappell (2000)</span>
observed that each patient may provide a weight, <span class="math inline">\(w_i\)</span>, reflecting the extend to which their
outcome has been evaluated. The weighted likelihood is</p>
<p><span class="math display">\[ L_J(\theta) = \prod_{i=1}^J \left\{ w_i
F(x_i, \theta) \right\}^{Y_i} \left\{ 1 - w_i F(x_i, \theta)
\right\}^{1-Y_i} \]</span></p>
<p>TITE-CRM weights the outcomes according to the extend to which
patients have completed the evaluation period. To illustrate the design,
we reproduce the example given on p.124 of <span class="citation">Ying
Kuen Cheung (2011)</span>. Four patients have been treated at dose-level
3 and all are part-way through the 126-day toxicity evaluation
window.</p>
<p>The authors use the empiric model so that there is one parameter,
<span class="math inline">\(\theta = \beta\)</span>, the dose-toxicity
relation is <span class="math inline">\(F(x_i, \beta) =
x_i^{exp(\beta)}\)</span>, and a <span class="math inline">\(N(0,
\sigma_{\beta}^2)\)</span> prior is specified on <span class="math inline">\(\beta\)</span>.</p>
</div>
<div id="tite-nbg" class="section level2">
<h2>TITE-NBG</h2>
<p><span class="citation">Neuenschwander, Branson, and Gsponer
(2008)</span> (NBG) introduced a derivative of the CRM for
dose-escalation clinical trials using a two-parameter model (see the NBG
vignette).</p>
<p>The authors did not introduce a time-to-event variant of their design
but it was simple to add one to <code>escalation</code> using the same
method presented above with a weight parameter, <span class="math inline">\(w\)</span>. We demonstrate that method here
alongside TITE-CRM.</p>
</div>
</div>
<div id="implementation-in-escalation" class="section level1">
<h1>Implementation in <code>escalation</code></h1>
<div id="tite-crm-1" class="section level2">
<h2>TITE-CRM</h2>
<p>As with the regular CRM, we require a dose-toxicity skeleton and a
target toxicity value. For illustration, we use the same parameters as
used in the plain CRM vignette:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(escalation)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>skeleton <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.12</span>, <span class="fl">0.25</span>, <span class="fl">0.40</span>, <span class="fl">0.55</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>target <span class="ot">&lt;-</span> <span class="fl">0.25</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>a0 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>beta_sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fl">1.34</span>)</span></code></pre></div>
<p><code>a0</code> is the fixed intercept value and <code>beta_sd</code>
is the SD of the slope parameter. We then have design:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">get_dfcrm_tite</span>(</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  <span class="at">skeleton =</span> skeleton, </span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">target =</span> target,</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="at">model =</span> <span class="st">&quot;logistic&quot;</span>, </span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="at">intcpt =</span> a0, </span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="at">scale =</span> beta_sd</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>)</span></code></pre></div>
<p>Elsewhere in <code>escalation</code>, we have represented outcomes
using character strings. The complexity of specifying patient-level
weights prevents that approach in time-to-event trials. Instead we
represent outcomes in data-frames. For example:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>outcomes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="at">dose =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="at">tox =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="at">weight =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.9</span>, <span class="dv">1</span>, <span class="fl">0.5</span>),</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="at">cohort =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>outcomes</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 4</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt;    dose   tox weight cohort</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; 1     1     0    1        1</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt; 2     1     0    1        2</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt; 3     2     0    1        3</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt; 4     2     0    0.9      4</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#&gt; 5     3     1    1        5</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#&gt; 6     3     0    0.5      6</span></span></code></pre></div>
<p>represents a scenario where we have sequentially had two patients
each at dose-levels 1, 2 and 3. The first three patients have been fully
evaluated as tolerating treatment (their <code>tox</code> parameters are
0 and their <code>weight</code> parameters are 1). The fifth patient is
also fully-weighted because they unfortunately experienced toxicity
(their <code>tox</code> parameter is 1 and their <code>weight</code>
parameter is also 1). Finally, the fourth and sixth patients are still
being evaluated without having experienced toxicity so far (their
<code>tox</code> parameters are 0 and their <code>weight</code>
parameters are less than 1).</p>
<p>To fit the model to these outcomes, we run:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> model <span class="sc">%&gt;%</span> <span class="fu">fit</span>(outcomes)</span></code></pre></div>
<p>The usual generic functions apply:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">print</span>(x)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt; Patient-level data:</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt;   Patient Cohort  Dose   Tox Weight</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt;     &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; 1       1      1     1     0    1  </span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; 2       2      2     1     0    1  </span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; 3       3      3     2     0    1  </span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; 4       4      4     2     0    0.9</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; 5       5      5     3     1    1  </span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; 6       6      6     3     0    0.5</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; Dose-level data:</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 9</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt;   dose     tox     n empiric_tox_rate mean_prob_tox median_prob_tox admissible</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt;   &lt;ord&gt;  &lt;dbl&gt; &lt;dbl&gt;            &lt;dbl&gt;         &lt;dbl&gt;           &lt;dbl&gt; &lt;lgl&gt;     </span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt; 1 NoDose     0     0              0          0               0      TRUE      </span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt; 2 1          0     2              0          0.0748          0.0748 TRUE      </span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt; 3 2          0     2              0          0.164           0.164  TRUE      </span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt; 4 3          1     2              0.5        0.310           0.310  TRUE      </span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt; 5 4          0     0            NaN          0.460           0.460  TRUE      </span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="co">#&gt; 6 5          0     0            NaN          0.599           0.599  TRUE      </span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="co">#&gt; # ℹ 2 more variables: recommended &lt;lgl&gt;, Skeleton &lt;dbl&gt;</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a><span class="co">#&gt; The model targets a toxicity level of 0.25.</span></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a><span class="co">#&gt; The model advocates continuing at dose 3.</span></span></code></pre></div>
<p>Note the <code>Weight</code> columns in the patient-level output.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">recommended_dose</span>(x)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt; [1] 3</span></span></code></pre></div>
</div>
<div id="tite-nbg-1" class="section level2">
<h2>TITE-NBG</h2>
<p>Let us reuse the design presented and justified by <span class="citation">Neuenschwander, Branson, and Gsponer (2008)</span> and
demonstrated in the NBG vignette:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>dose <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">2.5</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>, <span class="dv">250</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">get_trialr_nbg_tite</span>(</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="at">real_doses =</span> dose, <span class="at">d_star =</span> <span class="dv">250</span>, <span class="at">target =</span> <span class="fl">0.3</span>,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  <span class="at">alpha_mean =</span> <span class="fl">2.15</span>, <span class="at">alpha_sd =</span> <span class="fl">0.84</span>,</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  <span class="at">beta_mean =</span> <span class="fl">0.52</span>, <span class="at">beta_sd =</span> <span class="fl">0.8</span>,</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">2020</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>)</span></code></pre></div>
<p>To fit the model to the outcomes from the TITE-CRM example, we
run:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> model <span class="sc">%&gt;%</span> <span class="fu">fit</span>(outcomes)</span></code></pre></div>
<p>The usual generic functions apply:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">print</span>(x)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; Patient-level data:</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt;   Patient Cohort  Dose   Tox    Weight</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt;     &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl[1d]&gt;</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; 1       1      1     1     0       1  </span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; 2       2      2     1     0       1  </span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; 3       3      3     2     0       1  </span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; 4       4      4     2     0       0.9</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; 5       5      5     3     1       1  </span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; 6       6      6     3     0       0.5</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; Dose-level data:</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; # A tibble: 16 × 9</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt;    dose     tox     n empiric_tox_rate mean_prob_tox median_prob_tox admissible</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt;    &lt;ord&gt;  &lt;dbl&gt; &lt;dbl&gt;            &lt;dbl&gt;         &lt;dbl&gt;           &lt;dbl&gt; &lt;lgl&gt;     </span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt;  1 NoDose     0     0              0          0               0      TRUE      </span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt;  2 1          0     2              0          0.0969          0.0585 TRUE      </span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt;  3 2          0     2              0          0.163           0.125  TRUE      </span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt;  4 3          1     2              0.5        0.241           0.213  TRUE      </span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt;  5 4          0     0            NaN          0.346           0.335  TRUE      </span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt;  6 5          0     0            NaN          0.420           0.419  TRUE      </span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">#&gt;  7 6          0     0            NaN          0.476           0.483  TRUE      </span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="co">#&gt;  8 7          0     0            NaN          0.522           0.534  TRUE      </span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="co">#&gt;  9 8          0     0            NaN          0.559           0.573  TRUE      </span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="co">#&gt; 10 9          0     0            NaN          0.618           0.636  TRUE      </span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="co">#&gt; 11 10         0     0            NaN          0.662           0.681  TRUE      </span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co">#&gt; 12 11         0     0            NaN          0.735           0.757  TRUE      </span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a><span class="co">#&gt; 13 12         0     0            NaN          0.781           0.804  TRUE      </span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="co">#&gt; 14 13         0     0            NaN          0.834           0.858  TRUE      </span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a><span class="co">#&gt; 15 14         0     0            NaN          0.865           0.889  TRUE      </span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a><span class="co">#&gt; 16 15         0     0            NaN          0.885           0.908  TRUE      </span></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a><span class="co">#&gt; # ℹ 2 more variables: recommended &lt;lgl&gt;, RealDose &lt;dbl&gt;</span></span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a><span class="co">#&gt; The model targets a toxicity level of 0.3.</span></span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a><span class="co">#&gt; The model advocates continuing at dose 4.</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">recommended_dose</span>(x)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#&gt; [1] 4</span></span></code></pre></div>
</div>
<div id="dose-paths" class="section level2">
<h2>Dose paths</h2>
<p>Dose-paths do not make sense for time-to-event designs because there
are practically infinite trial states once continuous patient-level
weights are considered. Dose-paths are not implemented.</p>
</div>
<div id="simulation" class="section level2">
<h2>Simulation</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>true_prob_tox <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.35</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>)</span></code></pre></div>
<p>For the sake of speed, we will run just a few iterations:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>num_sims <span class="ot">&lt;-</span> <span class="dv">20</span></span></code></pre></div>
<p>In real life, however, we would naturally run many iterations.</p>
<p>Let us restrict the design to a sample size of 12 for a quick
illustration. Running the simulation:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">get_dfcrm_tite</span>(</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="at">skeleton =</span> skeleton, </span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="at">target =</span> target,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="at">model =</span> <span class="st">&quot;logistic&quot;</span>, </span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  <span class="at">intcpt =</span> a0, </span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  <span class="at">scale =</span> beta_sd</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>  <span class="fu">stop_at_n</span>(<span class="at">n =</span> <span class="dv">12</span>)</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>sims <span class="ot">&lt;-</span> model <span class="sc">%&gt;%</span> </span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>  <span class="fu">simulate_trials</span>(</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>    <span class="at">num_sims =</span> num_sims, </span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>    <span class="at">true_prob_tox =</span> true_prob_tox,</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>    <span class="at">max_time =</span> <span class="dv">10</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>  )</span></code></pre></div>
<p>we see that from this small sample size that the low doses are most
likely to be recommended:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">prob_recommend</span>(sims)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#&gt; NoDose      1      2      3      4      5 </span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#&gt;   0.00   0.75   0.20   0.05   0.00   0.00</span></span></code></pre></div>
<p>with most patients treated at low dose-levels too:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">colMeans</span>(<span class="fu">n_at_dose</span>(sims))</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co">#&gt;    1    2    3    4    5 </span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">#&gt; 9.70 0.15 1.40 0.55 0.20</span></span></code></pre></div>
<p>The simulated trial durations could be of interest in a time-to-event
trial:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">trial_duration</span>(sims)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co">#&gt;  [1] 19.64932 17.92124 20.81784 20.33176 19.79155 19.20623 24.85348 23.14870</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#&gt;  [9] 17.31764 23.62735 23.21265 18.13445 23.99437 21.26878 20.89885 20.28926</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co">#&gt; [17] 24.72482 28.22818 23.73679 26.39005</span></span></code></pre></div>
<p>The <code>max_time</code> parameter was specified so that the design
could calculate the patient-level weights (i.e. how much of the
observation window had been completed). In the above example, patients
were assumed to arrive one at a time with the intra-patient arrival
times distributed by an Exponential(1) distribution; this is the
default. To override that, we specify a function in the
<code>sample_patient_arrivals</code> parameter. The function must take
the patient-level data-frame of the prevailing trial data as a parameter
(i.e. with columns <code>cohort</code>, <code>patient</code>,
<code>dose</code>, <code>tox</code>, and <code>time</code>), and return
a data-frame with column <code>time_delta</code> and <span class="math inline">\(n\)</span> rows containing the arrival deltas of
the next <span class="math inline">\(n\)</span> patients. For example,
consider that you want to evaluate patients in cohorts of two. This is
somewhat strange because a time-to-event design frees you from the
obligation to use cohorts, but it is simple to implement. We could
run:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>sims <span class="ot">&lt;-</span> model <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  <span class="fu">simulate_trials</span>(</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>    <span class="at">num_sims =</span> num_sims, </span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>    <span class="at">true_prob_tox =</span> true_prob_tox,</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>    <span class="at">max_time =</span> <span class="dv">10</span>,</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>    <span class="at">sample_patient_arrivals =</span> <span class="cf">function</span>(df) {</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>      <span class="fu">cohorts_of_n</span>(<span class="at">n =</span> <span class="dv">2</span>, <span class="at">mean_time_delta =</span> <span class="dv">1</span>)</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>    },</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>    <span class="at">return_all_fits =</span> <span class="cn">TRUE</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>  )</span></code></pre></div>
<p>Note: the <code>return_all_fits = TRUE</code> param means that every
model fit (all interims and final fits) are returned. We use it here to
peak into the way simulations occur. However, in a production run with a
large number of iterates and many patients, doing this could lead to
memory problems. By default, <code>return_all_fits</code> is
<code>FALSE</code>.</p>
<p>The patient arrival times for the (for instance) third simulated
trial iterate are random and always increasing:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;purrr&#39;</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:magrittr&#39;:</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt;     set_names</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="fu">map_dbl</span>(sims<span class="sc">$</span>fits[[<span class="dv">3</span>]], <span class="st">&quot;time&quot;</span>)</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt; [1]  0.000000  1.158482  2.835637  4.883962  7.830599  9.916354 10.534122</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt; [8] 20.534122</span></span></code></pre></div>
<p>However, the doses given (patients in columns, simulated iterates in
rows) appear in pairs to reflect that patients were treated in cohorts
of two:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">doses_given</span>(sims)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="co">#&gt;  [1,]    1    1    3    3    4    4    5    5    3     3     3     3</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co">#&gt;  [2,]    1    1    3    3    4    4    1    1    1     1     1     1</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co">#&gt;  [3,]    1    1    3    3    1    1    1    1    1     1     1     1</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co">#&gt;  [4,]    1    1    3    3    4    4    1    1    1     1     1     1</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co">#&gt;  [5,]    1    1    1    1    1    1    1    1    1     1     1     1</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co">#&gt;  [6,]    1    1    3    3    4    4    1    1    1     1     1     1</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="co">#&gt;  [7,]    1    1    1    1    1    1    1    1    1     1     1     1</span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co">#&gt;  [8,]    1    1    3    3    1    1    1    1    1     1     1     1</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="co">#&gt;  [9,]    1    1    1    1    1    1    1    1    1     1     1     1</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="co">#&gt; [10,]    1    1    3    3    1    1    1    1    1     1     1     1</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="co">#&gt; [11,]    1    1    3    3    1    1    1    1    1     1     1     1</span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="co">#&gt; [12,]    1    1    3    3    1    1    1    1    1     1     1     1</span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="co">#&gt; [13,]    1    1    1    1    1    1    1    1    1     1     1     1</span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="co">#&gt; [14,]    1    1    3    3    4    4    1    1    1     1     1     1</span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a><span class="co">#&gt; [15,]    1    1    3    3    1    1    1    1    1     1     1     1</span></span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a><span class="co">#&gt; [16,]    1    1    1    1    1    1    1    1    1     1     1     1</span></span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a><span class="co">#&gt; [17,]    1    1    3    3    1    1    1    1    1     1     1     1</span></span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a><span class="co">#&gt; [18,]    1    1    4    4    1    1    1    1    1     1     1     1</span></span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a><span class="co">#&gt; [19,]    1    1    3    3    1    1    1    1    1     1     1     1</span></span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a><span class="co">#&gt; [20,]    1    1    3    3    1    1    1    1    1     1     1     1</span></span></code></pre></div>
<p>The inclusion of <code>df</code> as a parameter in the call to
<code>sample_patient_arrivals</code> lets you tailor the patient arrival
process in many creative ways, including variable cohort sizes, minimum
intra-patient gaps, etc.</p>
<p>For more information on running dose-finding simulations, refer to
the simulation vignette.</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Cheung2000" class="csl-entry">
Cheung, Y K, and R Chappell. 2000. <span>“Sequential Designs for Phase
<span>I</span> Clinical Trials with Late-Onset Toxicities.”</span>
<em>Biometrics</em> 56 (4): 1177–82.
</div>
<div id="ref-Cheung2011" class="csl-entry">
Cheung, Ying Kuen. 2011. <em>Dose <span>Finding</span> by the
<span>Continual Reassessment Method</span></em>. New York: <span>Chapman
&amp; Hall / CRC Press</span>.
</div>
<div id="ref-Neuenschwander2008" class="csl-entry">
Neuenschwander, Beat, Michael Branson, and Thomas Gsponer. 2008.
<span>“<span class="nocase">Critical aspects of the Bayesian approach to
phase I cancer trials</span>.”</span> <em>Statistics in Medicine</em>
27: 2420–39. <a href="https://doi.org/10.1002/sim.3230">https://doi.org/10.1002/sim.3230</a>.
</div>
<div id="ref-OQuigley1990" class="csl-entry">
O’Quigley, J, M Pepe, and L Fisher. 1990. <span>“Continual Reassessment
Method: A Practical Design for Phase 1 Clinical Trials in
Cancer.”</span> <em>Biometrics</em> 46 (1): 33–48. <a href="https://doi.org/10.2307/2531628">https://doi.org/10.2307/2531628</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
